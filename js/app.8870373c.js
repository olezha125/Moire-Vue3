(function(){"use strict";var t={3448:function(t,e,r){r.d(e,{l$:function(){return h},Gn:function(){return n},qo:function(){return _},U4:function(){return y},A4:function(){return m},f_:function(){return c},fA:function(){return g},I0:function(){return s},b4:function(){return l},lW:function(){return p},pe:function(){return d},mv:function(){return u},N:function(){return a},Eo:function(){return f}});const o="https://vue-moire.skillbox.cc";var i=r(4161);async function a(t){return i.Z.get(`${o}/api/products`,{params:t})}async function s(t){return i.Z.get(`${o}/api/products/${t}`)}async function n(t){return i.Z.post(`${o}/api/orders`,t,{params:{userAccessKey:t.userAccessKey}})}async function c(t,e){return i.Z.get(`${o}/api/orders/${t}`,{params:{userAccessKey:e.userAccessKey}})}async function l(){return i.Z.get(`${o}/api/productCategories`)}async function d(){return i.Z.get(`${o}/api/materials`)}async function u(){return i.Z.get(`${o}/api/seasons`)}async function p(){return i.Z.get(`${o}/api/colors`)}async function m(){return i.Z.get(`${o}/api/deliveries`)}async function g(t){return i.Z.get(`${o}/api/payments`,{params:{deliveryTypeId:t}})}async function h(t,e){return i.Z.post(`${o}/api/baskets/products`,t,{params:e})}async function f(t,e){return i.Z.put(`${o}/api/baskets/products`,t,{params:e})}async function _(t,e){return i.Z.delete(`${o}/api/baskets/products`,{data:t,params:e})}async function y(t){return i.Z.get(`${o}/api/baskets`,{params:t})}},495:function(t,e,r){var o=r(9242),i=(r(7658),r(3396)),a=r(7139),s=r.p+"img/logo-moire.86b9e557.svg";const n={class:"app-content"},c={class:"header container"},l={class:"header__wrapper"},d=(0,i._)("span",{class:"header__info"},"Каталог",-1),u=(0,i._)("img",{src:s,alt:"Логотип интернет магазина Moire",width:"116",height:"34"},null,-1),p=[u],m=(0,i._)("a",{class:"header__tel",href:"tel:8 800 600 90 09"}," 8 800 600 90 09 ",-1),g={class:"footer container"},h={class:"footer__wrapper"},f=(0,i.uE)('<ul class="footer__links"><li><a class="footer__link" href="#"> Каталог </a></li><li><a class="footer__link" href="tel:88006009009"> 8 800 600 90 09 </a></li><li><a class="footer__link" href="mailto:hi@technozavrrr.com"> hi@technozavrrr.com </a></li><li><a class="footer__link" href="#"> Распродажа </a></li><li><a class="footer__link footer__link--medium" href="#"> Заказать звонок </a></li></ul><ul class="footer__social social"><li class="social__item"><a class="social__link" href="#" aria-label="Вконтакте"><svg width="20" height="11" fill="currentColor"><use xlink:href="#icon-vk"></use></svg></a></li><li class="social__item"><a class="social__link" href="#" aria-label="Инстаграм"><svg width="17" height="17" fill="currentColor"><use xlink:href="#icon-insta"></use></svg></a></li><li class="social__item"><a class="social__link" href="#" aria-label="Facebook"><svg width="17" height="17" fill="currentColor"><use xlink:href="#icon-facebook"></use></svg></a></li><li class="social__item"><a class="social__link" href="#" aria-label="Twitter"><svg width="17" height="14" fill="currentColor"><use xlink:href="#icon-twitter"></use></svg></a></li><li class="social__item"><a class="social__link" href="#" aria-label="Telegram"><svg width="19" height="17" fill="currentColor"><use xlink:href="#icon-telegram"></use></svg></a></li></ul><p class="footer__desc"> Все права на материалы, находящиеся на сайте, охраняются в соответствии законодательством РФ, в том числе авторском праве и смежных правах. </p><ul class="footer__data"><li><a class="footer__link" href="#" target="_blank" rel="noopener" type="application/pdf"> Политика конфиденциальности </a></li><li><a class="footer__link" href="#" target="_blank" rel="noopener" type="application/pdf"> Публичная оферта </a></li></ul>',4),_={class:"footer__copyright"},y=(0,i._)("div",{id:"teleport-target"},null,-1);function P(t,e,r,s,u,P){const v=(0,i.up)("BaseNotification"),b=(0,i.up)("CartIndicator"),I=(0,i.up)("router-view");return(0,i.wg)(),(0,i.iD)("div",n,[(0,i.Wm)(v),(0,i._)("header",c,[(0,i._)("div",l,[d,(0,i._)("a",{class:"header__logo",href:"#",onClick:e[0]||(e[0]=(0,o.iM)((e=>t.$router.push({name:"catalog"})),["prevent"]))},p),m,(0,i.Wm)(b)])]),(0,i.Wm)(I),(0,i._)("footer",g,[(0,i._)("div",h,[f,(0,i._)("span",_," © "+(0,a.zw)((new Date).getFullYear())+" Moire ",1)])]),y])}var v=r(65);const b=(0,i._)("svg",{width:"19",height:"24"},[(0,i._)("use",{"xlink:href":"#icon-cart"})],-1),I={key:0,class:"header__count","aria-label":"Количество товаров"};function C(t,e,r,o,s,n){const c=(0,i.up)("SpinnerSpring"),l=(0,i.up)("router-link");return(0,i.wg)(),(0,i.j4)(l,{class:"header__cart","aria-label":"Корзина с товарами",to:{name:"cart"}},{default:(0,i.w5)((()=>[b,(0,i.Wm)(c,{class:"spinner-indicator",visible:t.cartLoading,size:"small"},null,8,["visible"]),t.cartLoading?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",I,(0,a.zw)(t.cartProductsCount),1))])),_:1})}var k=r(8455),w={name:"CartIndicator",components:{SpinnerSpring:k.Z},computed:{...(0,v.Se)(["cartProductsCount","cartProductsItemsCount","cartLoading","cartLoadingFailed"])}},S=r(89);const A=(0,S.Z)(w,[["render",C]]);var T=A;const x={class:"notification"},D={class:"notification__icon"},F={class:"material-icons",style:{"font-size":"50px"}},M={class:"notification__buttons"},$={key:0,class:"button notification__button"},L={key:1,class:"button notification__button"};function N(t,e,r,s,n,c){return(0,i.wg)(),(0,i.iD)("div",x,[(0,i.Wm)(o.W3,{name:"notification-animate",class:"notification__list",tag:"div"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.messages,(e=>((0,i.wg)(),(0,i.iD)("div",{class:(0,a.C_)(["notification__content",e.type]),key:e.id},[(0,i._)("div",D,[(0,i._)("i",F,(0,a.zw)(c.messageIcon(e?.type)),1)]),(0,i._)("div",(0,i.dG)(t.$attrs,{class:"notification__text"}),[(0,i._)("span",null,(0,a.zw)(e.text),1)],16),(0,i._)("div",M,[r.leftButton.length?((0,i.wg)(),(0,i.iD)("button",$,(0,a.zw)(r.leftButton),1)):(0,i.kq)("",!0),r.rightButton.length?((0,i.wg)(),(0,i.iD)("button",L,(0,a.zw)(r.rightButton),1)):(0,i.kq)("",!0)])],2)))),128))])),_:1})])}var z={name:"BaseNotification",props:{rightButton:{type:String,default:()=>""},leftButton:{type:String,default:()=>""}},computed:{...(0,v.Se)(["messages"])},methods:{...(0,v.nv)(["hideNotification"]),messageIcon(t){switch(t){case"error":return"cancel";case"notify":return"check_circle";case"warning":return"error_outline";default:return"info"}}},watch:{messages:{handler(){this.hideNotification()},deep:!0}},mounted(){this.hideNotification()}};const K=(0,S.Z)(z,[["render",N]]);var O=K,Z={name:"App",components:{CartIndicator:T,BaseNotification:O},methods:{...(0,v.nv)(["loadCart","addNotification"]),...(0,v.OI)(["updateUserAccessKey"])},created(){const t=localStorage.getItem("userAccessKey");t&&this.updateUserAccessKey(t),this.loadCart()}};const U=(0,S.Z)(Z,[["render",P]]);var V=U,B=r(2483);const q={class:"content container"},E={class:"content__top"},W={class:"content__row"},j=(0,i._)("h1",{class:"content__title"},"Каталог",-1),R={class:"content__info"},H={class:"content__catalog"},Y={class:"catalog"};function J(t,e,r,o,s,n){const c=(0,i.up)("ProductFilter"),l=(0,i.up)("PageProductsSelect"),d=(0,i.up)("SpinnerSpring"),u=(0,i.up)("ProductList"),p=(0,i.up)("BasePagination");return(0,i.wg)(),(0,i.iD)("main",q,[(0,i._)("div",E,[(0,i._)("div",W,[j,(0,i._)("span",R,(0,a.zw)(t.countProductsString(n.countProducts)),1)])]),(0,i._)("div",H,[(0,i.Wm)(c,{"price-from":s.filterPriceFrom,"onUpdate:priceFrom":e[0]||(e[0]=t=>s.filterPriceFrom=t),"price-to":s.filterPriceTo,"onUpdate:priceTo":e[1]||(e[1]=t=>s.filterPriceTo=t),"category-id":s.filterCategoryId,"onUpdate:categoryId":e[2]||(e[2]=t=>s.filterCategoryId=t),"material-ids":s.filterMaterialIds,"onUpdate:materialIds":e[3]||(e[3]=t=>s.filterMaterialIds=t),"season-ids":s.filterSeasonIds,"onUpdate:seasonIds":e[4]||(e[4]=t=>s.filterSeasonIds=t),"color-ids":s.filterColorIds,"onUpdate:colorIds":e[5]||(e[5]=t=>s.filterColorIds=t),page:s.page,"onUpdate:page":e[6]||(e[6]=t=>s.page=t),onSubmit:e[7]||(e[7]=t=>n.updateUrlParams("submit")),onReset:e[8]||(e[8]=t=>n.updateUrlParams("reset"))},null,8,["price-from","price-to","category-id","material-ids","season-ids","color-ids","page"]),(0,i._)("section",Y,[(0,i.Wm)(l,{modelValue:n.productsPerPage,"onUpdate:modelValue":e[9]||(e[9]=t=>n.productsPerPage=t)},null,8,["modelValue"]),(0,i.Wm)(d,{visible:s.productsLoading,size:"large"},null,8,["visible"]),(0,i.Wm)(u,{products:n.products},null,8,["products"]),(0,i.Wm)(p,{page:s.page,"onUpdate:page":e[10]||(e[10]=t=>s.page=t),pages:n.countPages},null,8,["page","pages"])])])])}const G={class:"catalog__list"};function Q(t,e,r,a,s,n){const c=(0,i.up)("ProductItem");return(0,i.wy)(((0,i.wg)(),(0,i.iD)("ul",G,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(r.products,(t=>((0,i.wg)(),(0,i.j4)(c,{key:t.id,product:t},null,8,["product"])))),128))],512)),[[o.F8,n.checkList()]])}const X={class:"catalog__item"},tt={class:"catalog__pic"},et=["src","alt"],rt={class:"catalog__title"},ot={href:"#"},it={class:"catalog__price"},at={class:"catalog__wrapper"},st={class:"colors colors--black"},nt={class:"colors__label"},ct=["name","value","onChange"],lt=["title"];function dt(t,e,r,s,n,c){const l=(0,i.up)("ProductItemPopup"),d=(0,i.up)("router-link"),u=(0,i.up)("CartAddButton");return(0,i.wy)(((0,i.wg)(),(0,i.iD)("li",X,[t.isModalOpened?((0,i.wg)(),(0,i.j4)(l,{key:0,"product-id":r.product.id,"color-id":t.color,onCancelled:c.onCancelledAddingToCart,"onAdded:productToCart":c.onAddedToCart},null,8,["product-id","color-id","onCancelled","onAdded:productToCart"])):(0,i.kq)("",!0),(0,i.Wm)(d,{class:"catalog__link",to:{name:"product",params:{id:r.product.id},query:{color:t.color}}},{default:(0,i.w5)((()=>[(0,i._)("div",tt,[(0,i._)("img",{src:c.productImage,alt:r.product.title},null,8,et)]),(0,i._)("h3",rt,[(0,i._)("a",ot,(0,a.zw)(r.product.title),1)])])),_:1},8,["to"]),(0,i._)("div",it,(0,a.zw)(t.numberFormat(r.product.price))+" ₽",1),(0,i._)("div",at,[(0,i._)("ul",st,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)([...r.product.colors],(s=>((0,i.wg)(),(0,i.iD)("li",{class:"colors__item",key:r.product.id+s.id},[(0,i._)("label",nt,[(0,i.wy)((0,i._)("input",{class:"colors__radio sr-only",type:"radio",name:r.product.id,value:s.id,"onUpdate:modelValue":e[0]||(e[0]=e=>t.color=e),onChange:(0,o.iM)((t=>c.changeColor(s.id)),["prevent"])},null,40,ct),[[o.G2,t.color]]),(0,i._)("span",{class:"colors__value",style:(0,a.j5)({"background-color":s.color?.code}),title:s.color?.title},null,12,lt)])])))),128))]),(0,i.Wm)(u,{added:c.isAdded,adding:t.isAdding,title:c.cartAddButtonTitle,onClick:c.modalOpen},null,8,["added","adding","title","onClick"])])],512)),[[o.F8,c.checkProduct()]])}const ut={class:"button btn-cart btn-cart--add"},pt=(0,i._)("i",{class:"material-icons-outlined",style:{"font-size":"25px"}},"add_shopping_cart",-1),mt=[pt],gt=(0,i._)("i",{class:"material-icons",style:{"font-size":"25px"}},"shopping_cart",-1),ht=[gt];function ft(t,e,r,o,s,n){const c=(0,i.up)("SpinnerSpring");return(0,i.wg)(),(0,i.iD)("button",ut,[(0,i.Wm)(c,{class:"btn-cart__loading",visible:r.adding,size:"small",color:"white"},null,8,["visible"]),(0,i._)("span",{class:(0,a.C_)(["btn-cart__icon",{"btn-cart__icon--invisible":r.added||r.adding}])},mt,2),(0,i._)("span",{class:(0,a.C_)(["btn-cart__icon",{"btn-cart__icon--invisible":!r.added||r.adding}])},ht,2)])}var _t={name:"CartAddButton",props:["added","adding"],components:{SpinnerSpring:k.Z}};const yt=(0,S.Z)(_t,[["render",ft]]);var Pt=yt,vt=r(4693);const bt=r(1103);var It={name:"ProductItem",props:["product"],data:()=>({color:0,isAdding:!1,productToAdd:null,isModalOpened:!1}),computed:{productImage(){if(!this.product?.colors?.length)return"";const t=this.product.colors.find((t=>t.id===this.color));return t&&t.gallery?.length&&t.gallery[0].file?.url?t.gallery[0].file.url:bt},isAdded(){let t=this.product.itemsAdded?.filter((t=>t.productId===this.product.id&&t.quantity>0));return t&&t.length>0},cartAddButtonTitle(){return this.isAdded?"Добавлено в корзину":"Добавить в корзину"}},methods:{...(0,v.nv)(["addNotification","addProductToCart"]),checkProduct(){return this.product&&"object"===typeof this.product&&this.product.title},changeColor(t){this.color=t},modalOpen(){this.isAdding=!0,this.isModalOpened=!0},onCancelledAddingToCart(){this.isAdding=!1,this.isModalOpened=!1},onAddedToCart(t){const e=t;e.productId?(this.addProductToCart(e).then((()=>{this.addNotification({text:"Товар добавлен в корзину",type:"notify"})})).catch((t=>{console.log(t),this.addNotification({text:"Ошибка добавления в корзину",type:"error"})})).finally((()=>{this.isAdding=!1})),this.isModalOpened=!1):this.addNotification({text:"Товар не найден!",type:"error"})}},components:{CartAddButton:Pt,ProductItemPopup:(0,i.RC)({loader:()=>r.e(202).then(r.bind(r,8202)),delay:0,loadingComponent:()=>"<h2>Загрузка...</h2>"})},mixins:[vt.ZP],mounted(){this.color=this.product?.colors[0]?.id}};const Ct=(0,S.Z)(It,[["render",dt]]);var kt=Ct,wt={name:"ProductList",props:["products"],components:{ProductItem:kt},methods:{checkList(){return this.products?.length}}};const St=(0,S.Z)(wt,[["render",Q]]);var At=St;const Tt={class:"catalog__pagination pagination"},xt={class:"pagination__item"},Dt=(0,i._)("svg",{width:"8",height:"14",fill:"currentColor"},[(0,i._)("use",{"xlink:href":"#icon-arrow-left"})],-1),Ft=[Dt],Mt=["onClick"],$t={class:"pagination__item"},Lt=(0,i._)("svg",{width:"8",height:"14",fill:"currentColor"},[(0,i._)("use",{"xlink:href":"#icon-arrow-right"})],-1),Nt=[Lt];function zt(t,e,r,s,n,c){return(0,i.wg)(),(0,i.iD)("ul",Tt,[(0,i._)("li",xt,[(0,i._)("a",{class:(0,a.C_)(["pagination__link pagination__link--arrow",{"pagination__link--disabled":c.isFirstPage}]),"aria-label":"Предыдущая страница",onClick:e[0]||(e[0]=(0,o.iM)((t=>c.paginate(r.page-1)),["prevent"]))},Ft,2)]),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(r.pages,(t=>((0,i.wg)(),(0,i.iD)("li",{class:"pagination__item",key:t},[(0,i._)("a",{href:"#",class:(0,a.C_)(["pagination__link",{"pagination__link--current":t===r.page}]),onClick:(0,o.iM)((e=>c.paginate(t)),["prevent"])},(0,a.zw)(t),11,Mt)])))),128)),(0,i._)("li",$t,[(0,i._)("a",{class:(0,a.C_)(["pagination__link pagination__link--arrow",{"pagination__link--disabled":c.isLastPage}]),href:"#","aria-label":"Следующая страница",onClick:e[1]||(e[1]=(0,o.iM)((t=>c.paginate(r.page+1)),["prevent"]))},Nt,2)])])}var Kt={name:"BasePagination",props:["page","pages"],emits:["update:page"],computed:{isFirstPage(){return 1===this.page},isLastPage(){return this.page===this.pages}},methods:{paginate(t){this.isPageExists(t)&&this.$emit("update:page",t)},isPageExists(t){return t>=1&&t<=this.pages}}};const Ot=(0,S.Z)(Kt,[["render",zt]]);var Zt=Ot;const Ut={class:"filter"},Vt={class:"form__block"},Bt=(0,i._)("legend",{class:"form__legend"},"Цена",-1),qt={class:"form__label form__label--price"},Et=(0,i._)("span",{class:"form__value"},"От",-1),Wt={class:"form__label form__label--price"},jt=(0,i._)("span",{class:"form__value"},"До",-1),Rt={class:"form__block"},Ht=(0,i._)("legend",{class:"form__legend"},"Категория",-1),Yt={class:"form__label form__label--select"},Jt=(0,i._)("option",{value:"0",disabled:""},"Все категории",-1),Gt=["value"],Qt={class:"form__block"},Xt=(0,i._)("legend",{class:"form__legend"},"Материал",-1),te={class:"check-list"},ee={class:"check-list__label"},re=["id","value"],oe={class:"check-list__desc"},ie={class:"form__block"},ae=(0,i._)("legend",{class:"form__legend"},"Коллекция",-1),se={class:"check-list"},ne={class:"check-list__label"},ce=["id","value"],le={class:"check-list__desc"},de=(0,i._)("button",{class:"filter__submit button button--primery",type:"submit"}," Применить ",-1);function ue(t,e,r,s,n,c){const l=(0,i.up)("InputCurrency");return(0,i.wg)(),(0,i.iD)("aside",Ut,[(0,i._)("form",{class:"filter__form form",action:"#",method:"get",onSubmit:e[6]||(e[6]=(0,o.iM)(((...t)=>c.submit&&c.submit(...t)),["prevent"]))},[(0,i._)("fieldset",Vt,[Bt,(0,i._)("label",qt,[(0,i.Wm)(l,{name:"min-price",modelValue:n.currentPriceFrom,"onUpdate:modelValue":e[0]||(e[0]=t=>n.currentPriceFrom=t)},null,8,["modelValue"]),Et]),(0,i._)("label",Wt,[(0,i.Wm)(l,{name:"max-price",modelValue:n.currentPriceTo,"onUpdate:modelValue":e[1]||(e[1]=t=>n.currentPriceTo=t)},null,8,["modelValue"]),jt])]),(0,i._)("fieldset",Rt,[Ht,(0,i._)("label",Yt,[(0,i.wy)((0,i._)("select",{class:"form__select",name:"category","onUpdate:modelValue":e[2]||(e[2]=t=>n.currentCategoryId=t)},[Jt,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.categories,(t=>((0,i.wg)(),(0,i.iD)("option",{value:t.id,key:t.id},(0,a.zw)(t.title),9,Gt)))),128))],512),[[o.bM,n.currentCategoryId]])])]),(0,i._)("fieldset",Qt,[Xt,(0,i._)("ul",te,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.materials,(t=>((0,i.wg)(),(0,i.iD)("li",{class:"check-list__item",key:t.id},[(0,i._)("label",ee,[(0,i.wy)((0,i._)("input",{class:"check-list__check sr-only",type:"checkbox",name:"material",id:t.code,value:t.id,"onUpdate:modelValue":e[3]||(e[3]=t=>n.currentMaterialIds=t)},null,8,re),[[o.e8,n.currentMaterialIds]]),(0,i._)("span",oe,[(0,i.Uk)((0,a.zw)(t.title)+" ",1),(0,i._)("span",null,"("+(0,a.zw)(t.productsCount)+")",1)])])])))),128))])]),(0,i._)("fieldset",ie,[ae,(0,i._)("ul",se,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.seasons,(t=>((0,i.wg)(),(0,i.iD)("li",{class:"check-list__item",key:t.id},[(0,i._)("label",ne,[(0,i.wy)((0,i._)("input",{class:"check-list__check sr-only",type:"checkbox",name:"collection",id:t.code,value:t.id,"onUpdate:modelValue":e[4]||(e[4]=t=>n.currentSeasonIds=t)},null,8,ce),[[o.e8,n.currentSeasonIds]]),(0,i._)("span",le,[(0,i.Uk)((0,a.zw)(t.title)+" ",1),(0,i._)("span",null,"("+(0,a.zw)(t.productsCount)+")",1)])])])))),128))])]),de,c.isFiltersClear?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("button",{key:0,class:"filter__reset button button--second",type:"button",onClick:e[5]||(e[5]=(0,o.iM)((t=>c.reset()),["prevent"]))}," Сбросить "))],32)])}var pe=r(3448),me=r(1445);function ge(t,e,r,a,s,n){const c=(0,i.Q2)("money3");return(0,i.wy)(((0,i.wg)(),(0,i.iD)("input",{class:"form__input",type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>n.currentValue=t)},null,512)),[[o.nr,n.currentValue,void 0,{lazy:!0}],[c,s.config]])}var he=r(8585),fe={name:"InputCurrency",props:["modelValue"],emits:["update:modelValue"],data(){return{config:{prefix:"",suffix:"",thousands:" ",decimal:",",precision:0,disableNegative:!0,disabled:!1,min:0,max:null,allowBlank:!1,minimumNumberOfCharacters:0,shouldRound:!0,focusOnRight:!1,masked:!0,modelModifiers:{number:!1}}}},computed:{currentValue:{get(){return this.modelValue||0},set(t){this.$emit("update:modelValue",(0,he.CA)(t,this.config))}}},directives:{money3:he.S3}};const _e=(0,S.Z)(fe,[["render",ge]]);var ye=_e,Pe={name:"ProductFilter",props:["priceFrom","priceTo","categoryId","materialIds","seasonIds","colorIds","page"],data(){return{currentPriceFrom:0,currentPriceTo:0,currentCategoryId:0,currentMaterialIds:[],currentSeasonIds:[],currentColorIds:[],categories:[],materials:[],seasons:[],colors:[]}},computed:{isFiltersClear(){return!this.currentPriceFrom&&!this.currentPriceTo&&!this.currentCategoryId&&!this.currentMaterialIds?.length&&!this.currentSeasonIds?.length&&!this.currentColorIds?.length}},watch:{priceFrom(t){this.currentPriceFrom=t},priceTo(t){this.currentPriceTo=t},categoryId(t){this.currentCategoryId=t},materialIds(t){this.currentColorId=t},seasonIds(t){this.currentColorId=t},colorIds(t){this.currentColorId=t}},methods:{...(0,v.nv)(["addNotification"]),submit(){this.$emit("update:priceFrom",this.currentPriceFrom),this.$emit("update:priceTo",this.currentPriceTo),this.$emit("update:categoryId",this.currentCategoryId),this.$emit("update:materialIds",this.currentMaterialIds),this.$emit("update:seasonIds",this.currentSeasonIds),this.$emit("update:colorIds",this.currentColorIds),this.$emit("update:page",1),this.$emit("submit",!0)},reset(){this.currentPriceFrom=0,this.currentPriceTo=0,this.currentCategoryId=0,this.currentMaterialIds=[],this.currentSeasonIds=[],this.currentColorIds=[],this.$emit("update:priceFrom",this.currentPriceFrom),this.$emit("update:priceTo",this.currentPriceTo),this.$emit("update:categoryId",this.currentCategoryId),this.$emit("update:materialIds",this.currentMaterialIds),this.$emit("update:seasonIds",this.currentSeasonIds),this.$emit("update:colorIds",this.currentColorIds),this.$emit("reset",!0)},loadCategories(){(0,pe.b4)().then((t=>{const e=t.data?.items;e.length&&(this.categories=e)})).catch((t=>{console.log(t);const e=t.response?.data?.error?.message;this.addNotification({text:"Ошибка загрузки списка категорий: "+me.R0.find((e=>e.code==t.response.status))?.caption??e,type:"error"})}))},loadMaterials(){(0,pe.pe)().then((t=>{const e=t.data?.items;e.length&&(this.materials=e)})).catch((t=>{console.log(t);const e=t.response?.data?.error?.message;this.addNotification({text:"Ошибка загрузки списка материалов: "+me.R0.find((e=>e.code==t.response.status))?.caption??e,type:"error"})}))},loadSeasons(){(0,pe.mv)().then((t=>{const e=t.data?.items;e.length&&(this.seasons=e)})).catch((t=>{console.log(t);const e=t.response?.data?.error?.message;this.addNotification({text:"Ошибка загрузки списка коллекций: "+me.R0.find((e=>e.code==t.response.status))?.caption??e,type:"error"})}))},loadColors(){(0,pe.lW)().then((t=>{const e=t.data?.items;e.length&&(this.colors=e)})).catch((t=>{console.log(t);const e=t.response?.data?.error?.message;this.addNotification({text:"Ошибка загрузки списка цветов: "+me.R0.find((e=>e.code==t.response.status))?.caption??e,type:"error"})}))},toggleMaterial(t){this.currentMaterialIds.find((e=>e===t))?this.currentMaterialIds=this.currentMaterialIds.filter((e=>e!==t)):this.currentMaterialIds.push(t)},toggleSeason(t){this.currentSeasonIds.find((e=>e===t))?this.currentSeasonIds=this.currentSeasonIds.filter((e=>e!==t)):this.currentSeasonIds.push(t)},toggleColor(t){this.currentColorIds.find((e=>e===t))?this.currentColorIds=this.currentColorIds.filter((e=>e!==t)):this.currentColorIds.push(t)}},components:{InputCurrency:ye},created(){this.loadCategories(),this.loadMaterials(),this.loadSeasons(),this.loadColors()},mounted(){this.currentPriceFrom=this.priceFrom,this.currentPriceTo=this.priceTo,this.currentCategoryId=this.categoryId,this.currentMaterialIds=this.materialIds,this.currentSeasonIds=this.seasonIds,this.currentColorIds=this.colorIds}};const ve=(0,S.Z)(Pe,[["render",ue]]);var be=ve;const Ie={class:"page-products"},Ce={class:"form__label form__label--select page-products__label",for:"page-products-count"},ke=(0,i._)("span",{class:"page-products__text"},"Товаров на странице:",-1),we=["value"];function Se(t,e,r,s,n,c){return(0,i.wg)(),(0,i.iD)("div",Ie,[(0,i._)("label",Ce,[ke,(0,i.wy)((0,i._)("select",{class:"form__select page-products__select",name:"page-products",id:"page-products-count","onUpdate:modelValue":e[0]||(e[0]=t=>c.currentProductsPerPage=t)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(c.productsPerPageList,(t=>((0,i.wg)(),(0,i.iD)("option",{value:t,key:t},(0,a.zw)(t),9,we)))),128))],512),[[o.bM,c.currentProductsPerPage]])])])}var Ae={name:"PageProductsSelect",props:["modelValue"],emits:["update:modelValue"],computed:{productsPerPageList(){return me.QE},currentProductsPerPage:{get(){return this.modelValue||1},set(t){t!=this.currentProductsPerPage&&this.$emit("update:modelValue",t)}}}};const Te=(0,S.Z)(Ae,[["render",Se]]);var xe=Te,De={name:"CatalogView",data(){return{productsData:null,productsLoading:!1,productsLoadingFailed:!1,productsLoadingErrorCode:null,filterPriceFrom:0,filterPriceTo:0,filterCategoryId:this.$route.query.categoryId||0,filterMaterialIds:[],filterSeasonIds:[],filterColorIds:[],page:1}},computed:{...(0,v.Se)({productsPerPageSaved:"productsPerPageSaved",cartProducts:"cartProducts"}),products(){return(this.productsData?.items??[]).map((t=>{const e={...t,itemsAdded:this.cartProductItems(t.id)};return e}))},countProducts(){return this.productsData?this.productsData.pagination.total:0},countPages(){return this.productsData?.pagination?.pages??1},productsPerPage:{get(){return this.productsPerPageSaved},set(t){this.$store.commit("saveProductsPerPage",t)}}},methods:{...(0,v.nv)(["addNotification"]),updateUrlParams(t){if("reset"===t)return void this.$router.replace({query:{}});let e=!1;const r={};this.$route.query.categoryId!=this.filterCategoryId&&(e=!0,this.filterCategoryId&&(r.categoryId=this.filterCategoryId)),e&&this.$router.replace({query:r})},cartProductItems(t){let e=this.cartProducts?.filter((e=>e.productId===t))??[];return e?.length?(e=e.map((t=>({productId:t.productId,colorId:t.colorId,sizeId:t.sizeId,quantity:t.amount}))),e):[]},startLoading(){this.productsLoading=!0,this.productsLoadingFailed=!1,clearTimeout(this.loadProductsTimer)},stopLoading(){this.productsLoading=!1},loadProducts(t){this.startLoading(),this.loadProductsTimer=setTimeout((()=>{(0,pe.N)({minPrice:this.filterPriceFrom,maxPrice:this.filterPriceTo,categoryId:this.filterCategoryId,materialIds:this.filterMaterialIds,seasonIds:this.filterSeasonIds,colorIds:this.filterColorIds,page:t??this.page,limit:this.productsPerPage}).then((t=>{this.productsData=t.data})).catch((t=>{this.productsLoadingErrorCode=t.response.status,this.productsLoadingFailed=!0,console.log(t.response.statusText),this.addNotification({text:me.R0.find((e=>e.code==t.response.status))?.caption??t.response.statusText,type:"error"})})).finally((()=>this.stopLoading()))}),500)}},components:{ProductList:At,BasePagination:Zt,ProductFilter:be,PageProductsSelect:xe,SpinnerSpring:k.Z},mixins:[vt.ZP],watch:{filterPriceFrom(t,e){this.loadProducts(),console.log('изменилась "цена от" c '+e+" на "+t)},filterPriceTo(t,e){this.loadProducts(),console.log('изменилась "цена по" c '+e+" на "+t)},filterCategoryId(t,e){this.loadProducts(),console.log("изменилась категория c "+e+" на "+t)},filterMaterialIds:{handler(t,e){this.loadProducts(),console.log("изменились материалы с "+JSON.stringify(e)+" на "+JSON.stringify(t))},deep:!0},filterSeasonIds:{handler(t,e){this.loadProducts(),console.log("изменились сезоны с "+JSON.stringify(e)+" на "+JSON.stringify(t))},deep:!0},filterColorIds:{handler(t,e){this.loadProducts(),console.log("изменились цвета с "+JSON.stringify(e)+" на "+JSON.stringify(t))},deep:!0},page(t,e){this.loadProducts(),console.log("изменился номер текущей страницы c "+e+" на "+t)},productsPerPage(t,e){1===this.page?this.loadProducts():this.page=1,console.log("изменилось число продуктов на страницу с "+e+" на "+t)}},mounted(){this.loadProducts()}};const Fe=(0,S.Z)(De,[["render",J]]);var Me=Fe;const $e=[{path:"/",name:"catalog",component:Me},{path:"/product/:id",name:"product",component:()=>r.e(128).then(r.bind(r,3128))},{path:"/cart",name:"cart",component:()=>r.e(371).then(r.bind(r,4371))},{path:"/order",name:"order",component:()=>r.e(709).then(r.bind(r,9709))},{path:"/order/:id",name:"orderInfo",component:()=>r.e(433).then(r.bind(r,4433))},{path:"/:pathMatch(.*)*",name:"notFound",component:()=>r.e(509).then(r.bind(r,1509))}],Le=(0,B.p7)({history:(0,B.r5)("/Moire-Vue3/"),routes:$e,scrollBehavior(t,e,r){if(r||e.path==t.path){const t={left:r?.left,top:r?.top,behavior:"smooth"};return new Promise((e=>{setTimeout((()=>{e(t)}),1e3)}))}return{left:0,top:0}}});var Ne=Le;const ze={state:()=>({userAccessKey:null,productsPerPageSaved:9}),getters:{productsPerPageSaved(t){return t.productsPerPageSaved},userAccessKey(t){return t.userAccessKey}},mutations:{updateUserAccessKey(t,e){t.userAccessKey=e},saveProductsPerPage(t,e){Number.isInteger(e)&&(t.productsPerPageSaved=Math.max(6,e))}}},Ke={state:()=>({messages:[],messagesTimeout:4e3}),getters:{messages(t){return t.messages}},mutations:{addMessage(t,e){t.messages.push(e)},hideMessage(t){t.messages?.length&&setTimeout((()=>{t.messages.splice(0,1)}),t.messagesTimeout)}},actions:{addNotification(t,e){e?.text?.length&&t.commit("addMessage",{id:Date.now().toLocaleString(),text:e?.text,type:e?.type})},hideNotification(t){t.commit("hideMessage")}}},Oe={state:()=>({orderInfo:null}),getters:{orderInfo(t){return t.orderInfo}},mutations:{updateOrderInfo(t,e){t.orderInfo=e}}},Ze={state:()=>({cartProducts:[],cartProductsData:[],cartLoading:!1,cartLoadingFailed:!1}),getters:{cartLoading(t){return t.cartLoading},cartLoadingFailed(t){return t.cartLoadingFailed},cartProducts(t){return t.cartProducts},cartDetailProducts(t){return t.cartProducts.map((e=>{const{product:r}=t.cartProductsData.find((t=>t.product.id===e.productId)),o=r.colors.find((t=>t.color.id===e.colorId));return{...e,image:o.gallery?.length?o.gallery[0].file.url:"",color:o.color.title,colorCode:o.color.code}}))},cartTotalPrice(t,e){return e.cartDetailProducts.reduce(((t,e)=>t+e.product.price*e.amount),0)},cartProductsCount(t){return t.cartProducts.length},cartProductsItemsCount(t){return t.cartProducts.reduce(((t,e)=>t+e.amount),0)}},mutations:{resetCart(t){t.cartProducts=[],t.cartProductsData=[]},updateCartProductAmount(t,{id:e,amount:r}){const o=t.cartProducts.find((t=>t.id===e));o&&(o.amount=r)},deleteCartProduct(t,e){t.cartProducts=t.cartProducts.filter((t=>t.id!==e))},updateCartProductsData(t,e){t.cartProductsData=e},syncCartProducts(t){t.cartProducts=t.cartProductsData.map((t=>({id:t.id,productId:t.product.id,colorId:t.color.color.id,colorCaption:me.O9.find((e=>e.id===t.color.color.id))?.title,sizeId:t.size.id,sizeCaption:t.size.title,amount:t.quantity,product:{id:t.product.id,title:t.product.title,price:t.product.price,colors:t.product.colors}})))},updateCartLoading(t,e){t.cartLoading=e},updateCartLoadingFailed(t,e){t.cartLoadingFailed=e}},actions:{loadCart(t){t.commit("updateCartLoading",!0),t.commit("updateCartLoadingFailed",!1),setTimeout((()=>{(0,pe.U4)({userAccessKey:t.rootState.config.userAccessKey}).then((e=>{t.rootState.config.userAccessKey&&t.rootState.config.userAccessKey===e.data.user.accessKey||(localStorage.setItem("userAccessKey",e.data.user.accessKey),t.commit("updateUserAccessKey",e.data.user.accessKey),t.dispatch("addNotification",{text:"Корзина пуста",type:"warning"})),t.commit("updateCartProductsData",e.data.items),t.commit("syncCartProducts")})).catch((()=>{t.commit("updateCartLoadingFailed",!0)})).finally((()=>{t.commit("updateCartLoading",!1)}))}),500)},async addProductToCart(t,{productId:e,colorId:r,sizeId:o,quantity:i}){return t.commit("updateCartLoading",!0),new Promise((t=>setTimeout(t,1e3))).then((()=>(0,pe.l$)({productId:e,colorId:r,sizeId:o,quantity:i},{userAccessKey:t.rootState.config.userAccessKey}).then((e=>{t.commit("updateCartProductsData",e.data.items),t.commit("syncCartProducts")})).catch((e=>{const r=e?.response,o=r?.data?.error?.request;if(o){for(let e in o)t.dispatch("addNotification",{text:o[e],type:"error"});throw new Error("Ошибка: "+e.message)}})).finally((()=>{t.commit("updateCartLoading",!1)}))))},async updateCartProductAmount(t,{id:e,amount:r}){return t.commit("updateCartProductAmount",{id:e,amount:r}),r<1?null:(0,pe.Eo)({basketItemId:e,quantity:r},{userAccessKey:t.rootState.config.userAccessKey}).then((e=>{t.commit("updateCartProductsData",e.data.items)})).catch((e=>{t.commit("syncCartProducts"),t.dispatch("addNotification",{text:me.R0.find((t=>t.code===e.response.status))?.caption||e.response.statusText,type:"error"})})).finally((()=>{}))},async deleteCartProduct(t,e){return t.commit("deleteCartProduct",e),(0,pe.qo)({basketItemId:e},{userAccessKey:t.rootState.config.userAccessKey}).then((e=>{t.commit("updateCartProductsData",e.data.items)})).catch((e=>{throw console.log(e),t.commit("syncCartProducts"),t.dispatch("addNotification",{text:me.R0.find((t=>t.code===e.response.status))?.caption||e.response.statusText,type:"error"}),new Error("Ошибка: "+e.message)})).finally((()=>{}))}}};var Ue=(0,v.MT)({state:{},getters:{},mutations:{},actions:{},modules:{config:ze,notifications:Ke,orders:Oe,cart:Ze}});(0,o.ri)(V).use(Ue).use(Ne).mount("#app")},1445:function(t,e,r){r.d(e,{O9:function(){return o},QE:function(){return a},R0:function(){return i}});const o=[{id:20,title:"Красный"},{id:21,title:"Синий"},{id:22,title:"Зеленый "},{id:23,title:"Желтый "},{id:24,title:"Фиолетовый"},{id:25,title:"Розовый"},{id:26,title:"Черный"},{id:27,title:"Белый"}],i=[{code:400,caption:"Некорректные данные"},{code:404,caption:"Данные не найдены"},{code:500,caption:"Внутренняя ошибка сервера"}],a=[6,9,12,18,24,27,32]},4693:function(t,e,r){e.ZP={name:"functions",methods:{numberFormat(t){if(!t)return"";const e=(new Intl.NumberFormat).format(t);return Number.isNaN(e)?"":e},countProductsString(t){function e(t){return t>=10&&t<=20}if(e(t)||e(t%100)||e(t%1e3))return`${t} товаров`;const r=t%10;return 1===r?`${t} товар`:[2,3,4].includes(r)?`${t} товара`:`${t} товаров`},deliveryFormat(t){return 1===t?.id?"Бесплатно":`${t?.price||0} ₽`}}}},8455:function(t,e,r){r.d(e,{Z:function(){return h}});var o=r(3396);function i(t,e,r,i,a,s){const n=(0,o.up)("SpringSpinner"),c=(0,o.up)("BaseSpinner");return(0,o.wg)(),(0,o.j4)(c,{visible:t.visible,size:t.size},{default:(0,o.w5)((()=>[(0,o.Wm)(n,{"animation-duration":t.spinnerDuration,size:s.springSize,color:t.spinnerColor},null,8,["animation-duration","size","color"])])),_:1},8,["visible","size"])}var a=r(7139);function s(t,e,r,i,s,n){return r.visible?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,a.C_)(["spinner",n.spinnerClass])},[(0,o.WI)(t.$slots,"default")],2)):(0,o.kq)("",!0)}var n={name:"BaseSpinner",props:["visible","size"],computed:{spinnerClass(){return`spinner--${this.size}`}}},c=r(89);const l=(0,c.Z)(n,[["render",s]]);var d=l,u={name:"baseSpinnerMixin",props:["visible","size","color"],data(){return{spinnerDuration:2e3,defaultColor:"#e02d71"}},computed:{spinnerColor(){return this.color??this.defaultColor}},components:{BaseSpinner:d}},p=r(2942),m={name:"SpinnerRhombuses",data(){return{springSizes:{tiny:8,small:16,medium:32,large:44,huge:60}}},computed:{springSize(){return this.springSizes[this.size]}},components:{SpringSpinner:p.R},mixins:[u]};const g=(0,c.Z)(m,[["render",i]]);var h=g},1103:function(t,e,r){t.exports=r.p+"img/no-photo.22306a0b.jpg"}},e={};function r(o){var i=e[o];if(void 0!==i)return i.exports;var a=e[o]={exports:{}};return t[o].call(a.exports,a,a.exports,r),a.exports}r.m=t,function(){var t=[];r.O=function(e,o,i,a){if(!o){var s=1/0;for(d=0;d<t.length;d++){o=t[d][0],i=t[d][1],a=t[d][2];for(var n=!0,c=0;c<o.length;c++)(!1&a||s>=a)&&Object.keys(r.O).every((function(t){return r.O[t](o[c])}))?o.splice(c--,1):(n=!1,a<s&&(s=a));if(n){t.splice(d--,1);var l=i();void 0!==l&&(e=l)}}return e}a=a||0;for(var d=t.length;d>0&&t[d-1][2]>a;d--)t[d]=t[d-1];t[d]=[o,i,a]}}(),function(){r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,{a:e}),e}}(),function(){r.d=function(t,e){for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){r.f={},r.e=function(t){return Promise.all(Object.keys(r.f).reduce((function(e,o){return r.f[o](t,e),e}),[]))}}(),function(){r.u=function(t){return"js/"+t+"."+{128:"0b1ceed5",202:"aafe4bb2",371:"c14cede0",433:"c0e27058",509:"5b65f450",709:"b05b67af"}[t]+".js"}}(),function(){r.miniCssF=function(t){return"css/"+t+"."+{128:"281d92bc",202:"c5f69e9b",371:"820c0f30",709:"b97f6d5f"}[t]+".css"}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="moire:";r.l=function(o,i,a,s){if(t[o])t[o].push(i);else{var n,c;if(void 0!==a)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var u=l[d];if(u.getAttribute("src")==o||u.getAttribute("data-webpack")==e+a){n=u;break}}n||(c=!0,n=document.createElement("script"),n.charset="utf-8",n.timeout=120,r.nc&&n.setAttribute("nonce",r.nc),n.setAttribute("data-webpack",e+a),n.src=o),t[o]=[i];var p=function(e,r){n.onerror=n.onload=null,clearTimeout(m);var i=t[o];if(delete t[o],n.parentNode&&n.parentNode.removeChild(n),i&&i.forEach((function(t){return t(r)})),e)return e(r)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=p.bind(null,n.onerror),n.onload=p.bind(null,n.onload),c&&document.head.appendChild(n)}}}(),function(){r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){r.p="/Moire-Vue3/"}(),function(){if("undefined"!==typeof document){var t=function(t,e,r,o,i){var a=document.createElement("link");a.rel="stylesheet",a.type="text/css";var s=function(r){if(a.onerror=a.onload=null,"load"===r.type)o();else{var s=r&&("load"===r.type?"missing":r.type),n=r&&r.target&&r.target.href||e,c=new Error("Loading CSS chunk "+t+" failed.\n("+n+")");c.code="CSS_CHUNK_LOAD_FAILED",c.type=s,c.request=n,a.parentNode&&a.parentNode.removeChild(a),i(c)}};return a.onerror=a.onload=s,a.href=e,r?r.parentNode.insertBefore(a,r.nextSibling):document.head.appendChild(a),a},e=function(t,e){for(var r=document.getElementsByTagName("link"),o=0;o<r.length;o++){var i=r[o],a=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(a===t||a===e))return i}var s=document.getElementsByTagName("style");for(o=0;o<s.length;o++){i=s[o],a=i.getAttribute("data-href");if(a===t||a===e)return i}},o=function(o){return new Promise((function(i,a){var s=r.miniCssF(o),n=r.p+s;if(e(s,n))return i();t(o,n,null,i,a)}))},i={143:0};r.f.miniCss=function(t,e){var r={128:1,202:1,371:1,709:1};i[t]?e.push(i[t]):0!==i[t]&&r[t]&&e.push(i[t]=o(t).then((function(){i[t]=0}),(function(e){throw delete i[t],e})))}}}(),function(){var t={143:0};r.f.j=function(e,o){var i=r.o(t,e)?t[e]:void 0;if(0!==i)if(i)o.push(i[2]);else{var a=new Promise((function(r,o){i=t[e]=[r,o]}));o.push(i[2]=a);var s=r.p+r.u(e),n=new Error,c=function(o){if(r.o(t,e)&&(i=t[e],0!==i&&(t[e]=void 0),i)){var a=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.src;n.message="Loading chunk "+e+" failed.\n("+a+": "+s+")",n.name="ChunkLoadError",n.type=a,n.request=s,i[1](n)}};r.l(s,c,"chunk-"+e,e)}},r.O.j=function(e){return 0===t[e]};var e=function(e,o){var i,a,s=o[0],n=o[1],c=o[2],l=0;if(s.some((function(e){return 0!==t[e]}))){for(i in n)r.o(n,i)&&(r.m[i]=n[i]);if(c)var d=c(r)}for(e&&e(o);l<s.length;l++)a=s[l],r.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return r.O(d)},o=self["webpackChunkmoire"]=self["webpackChunkmoire"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=r.O(void 0,[998],(function(){return r(495)}));o=r.O(o)})();
//# sourceMappingURL=app.8870373c.js.map